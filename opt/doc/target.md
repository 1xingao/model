# 克里金插值参数优化方法说明

## 1. 背景
克里金插值依赖于**变异函数参数**（主要包括 nugget、sill、range）。  
参数选择直接影响插值结果的平滑性、精度和不确定性。  
目标是通过**优化算法**，在给定的候选模型（球状、指数、高斯等）下找到最优参数。

---

## 2. 优化目标
优化的目标函数通常基于交叉验证误差或似然函数：

- **交叉验证误差**  
  - 留一法 (LOO, Leave-One-Out Cross Validation)  
  - 指标：RMSE、MAE、Bias、R²

- **似然函数**  
  - 最大似然 (ML, Maximum Likelihood)  
  - 限制极大似然 (REML, Restricted Maximum Likelihood)  
  - 目标：最大化 log-likelihood

AI 在编程时，应允许用户选择目标函数。

---

## 3. 可用优化方法

### 3.1 经典统计方法
- **OLS / WLS**：最小二乘拟合经验半变异函数  
- **ML / REML**：最大化似然函数  
- 优点：稳健、实现简单  
- 缺点：容易陷入局部最优  

### 3.2 梯度型优化
- 算法：BFGS、L-BFGS、共轭梯度  
- 特点：利用梯度信息快速收敛  
- 使用场景：已有较好初值，需快速精调  

### 3.3 启发式全局优化
- **遗传算法 (GA)**  
- **粒子群优化 (PSO)**  
- **差分进化 (DE)**  
- 优点：全局搜索能力强，适合非凸目标函数  
- 缺点：计算开销大  
- 常用于 nugget、sill、range 的联合优化

### 3.4 贝叶斯与不确定性优化
- **MCMC**  
- **贝叶斯优化**  
- 输出参数分布而非点估计  
- 适用于对参数不确定性敏感的场景  

### 3.5 混合方法
- 先用全局优化（如 PSO/DE）搜索大范围解  
- 再用梯度法（如 L-BFGS）做局部收敛  
- 综合效率和精度

---

## 4. 参数搜索范围建议
在实际编程时需设置参数边界：
- **Nugget**: [0, 总方差 × 0.9]  
- **Sill**: [0.1 × 总方差, 总方差 × 1.5]  
- **Range**: [最小井距, 研究区范围 × 2]  

---

## 5. 推荐工作流

1. **输入数据**：钻孔坐标、属性值  
2. **设定模型类型**：球状 / 指数 / 高斯  
3. **计算经验半变异函数**（可选）  
4. **选择优化方法**  
   - 基线：WLS / REML  
   - 全局优化：PSO / DE  
   - 局部精调：L-BFGS  
   - 不确定性：MCMC / 贝叶斯优化  
5. **定义目标函数**：交叉验证 RMSE 或 log-likelihood  
6. **运行优化**  
7. **输出结果**：最优 nugget、sill、range，及拟合优度指标  

---

## 6. 输出格式示例
```json
{
  "model": "spherical",
  "nugget": 0.15,
  "sill": 1.2,
  "range": 320,
  "objective": "RMSE",
  "rmse": 0.45
}
```
## 其他

我的opt文件夹中包含了遗传算法（GA）、粒子群算法（PSO）、蚁群算法（ACO）请你整理一下他们的代码并且参照格式来编写新的代码（原有算法中的可视化代码删除，在一个新的文件中调用这些算法来执行并可视化），如果有相同的可复用的代码请创建一个公共基类并继承、需要用的会用来更改的超参数定义为常量放啊在最上方。每一个算法要求为一个单独的文件并使用类方法进行封装、并在结尾以注释的形式参数算法的基本逻辑